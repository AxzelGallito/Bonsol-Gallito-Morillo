{% extends 'base.html' %}

{% block title %} Review Your Order {% endblock %}

{% block body %}

<style>
body {
    background-image: linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.55)),
                      url('/static/images/BG2.jpg');
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    background-attachment: fixed;
    font-family: "Poppins", sans-serif;
    color: #fff;
}

.review-card {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    border: 1px solid rgba(255,255,255,0.15);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    padding: 25px;
    margin-bottom: 20px;
}

.review-card h4 {
    color: #5ce1e6;
    font-weight: 600;
    margin-bottom: 20px;
}

.review-item {
    display: flex;
    align-items: center;
    border-bottom: 1px solid rgba(255,255,255,0.2);
    padding-bottom: 15px;
    margin-bottom: 15px;
}

.review-item img {
    height: 70px;
    width: 70px;
    border-radius: 8px;
    margin-right: 15px;
}

.review-item h5 {
    color: #5ce1e6;
    margin-bottom: 5px;
}

.review-item p,
.review-item strong {
    color: #fff;
    margin: 0;
}

.review-summary div {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    color: #fff;
}

.review-summary hr {
    border-color: rgba(255,255,255,0.2);
}

.review-summary h5 {
    color: #5ce1e6;
}

.btn-glass {
    background: #5ce1e6;
    color: #000;
    font-weight: 600;
    border-radius: 12px;
    border: none;
    padding: 10px;
    width: 100%;
    transition: all 0.3s ease;
}

.btn-glass:hover {
    background: #3cbac3;
    color: #fff;
    box-shadow: 0 0 12px rgba(92,225,230,0.5);
}
</style>

<div class="container my-5">

    <div class="text-center mb-4">
        <h2 style="color:#5ce1e6;">Review Your Order</h2>
    </div>

    <div class="row justify-content-center g-4">

        <!-- LEFT SIDE - ITEMS -->
        <div class="col-md-7">
            <div class="review-card">

                <h4>Selected Items</h4>

                {% for item in items %}
                <div class="review-item">

                    <img src="{{ item.picture }}" alt="{{ item.name }}">

                    <div>
                        <h5>{{ item.name }}</h5>
                        <p>Price: Php {{ item.price }} Ã— {{ item.quantity }}</p>
                        <strong>Subtotal: Php {{ item.subtotal }}</strong>
                    </div>

                </div>
                {% endfor %}

            </div>
        </div>

        <!-- RIGHT SIDE - ORDER SUMMARY -->
        <div class="col-md-4">
            <div class="review-card review-summary">

                <h4>Order Summary</h4>

                {% for item in items %}
                <div>
                    <small>{{ item.name }} (x{{ item.quantity }})</small>
                    <small>Php {{ item.subtotal }}</small>
                </div>
                {% endfor %}

                <hr>

                <div>
                    <strong>Amount</strong>
                    <strong>Php {{ amount }}</strong>
                </div>

                <div>
                    <small>Shipping</small>
                    <small>Php {{ shipping }}</small>
                </div>

                <div class="mt-2">
                    <h5>Total</h5>
                    <h5>Php {{ total_with_shipping }}</h5>
                </div>

                <hr>

                <h5>Delivery Address</h5>
                {% if customer_address %}
                    <p>{{ customer_address }}</p>
                {% else %}
                    <p class="text-danger">No address saved.</p>
                {% endif %}

                <hr>

                <h5>Payment Method</h5>
                <p>Cash on Delivery (COD)</p>

                <form action="/confirm-order" method="POST">
                    {% if direct_item_id %}
                        <input type="hidden" name="direct_item_id" value="{{ direct_item_id }}">
                    {% endif %}
                    {% for item in items %}
                        {% if item.cart_id %}
                            <input type="hidden" name="selected_items[]" value="{{ item.cart_id }}">
                        {% endif %}
                    {% endfor %}
                    <button type="submit" class="btn-glass mb-2">Confirm & Pay</button>
                </form>

                <a href="/cart" class="btn btn-secondary w-100">Back to Cart</a>

            </div>
        </div>

    </div>

</div>

{% endblock %}
    